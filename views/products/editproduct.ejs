<!DOCTYPE html>
<html lang="es">
<%-include ('../partials/head.ejs', {estilo:'editproduct'})%>

    <body>
        <%-include ('../partials/header.ejs')%>
            <%-include ('../partials/nav-bar.ejs')%>
                <main>
                    <%-include ('../partials/button-top.ejs')%>
                        <section class="cargaproducto">
                            <h2>Editar producto</h2>
                            <form action="/products/detail/<%= producto.id %>?_method=put" method="POST"
                                enctype="multipart/form-data" class="formulario" id="formulario">
                                <div>
                                    <label for="nombre">Nombre del Producto:</label>
                                    <input type="text" name="nombre" id="producto"
                                        placeholder="* Nombre del Producto" value="<%= producto.nombre%>" />
                                </div>
                                <div class="error-container">
                                    <% if (mapsDeError.nombre) { %>
                                        <p class="errorValidator">
                                            <%= mapsDeError.nombre.msg %>
                                        </p>
                                        <% }%>
                                </div>
                                <div>
                                    <label for="precio">Precio: </label>
                                    <input type="text" name="precio" id="precio" value="<%= producto.precio %>">
                                </div>
                                <div class="error-container">
                                    <% if (mapsDeError.precio) { %>
                                        <p class="errorValidator">
                                            <%= mapsDeError.precio.msg %>
                                        </p>
                                        <% }%>
                                </div>
                                <div>
                                    <label for="color">Color: </label>
                                    <input type="text" name="color" id="color" value="<%= producto.color %>">
                                </div>
                                <div class="error-container">
                                    <% if (mapsDeError.color) { %>
                                        <p class="errorValidator">
                                            <%= mapsDeError.color.msg %>
                                        </p>
                                        <% }%>
                                </div>
                                <div>
                                    <label for="marca">Marca: </label>
                                    <select name="marca" id="marca">
                                        <% for( let i=0; i < marcas.length; i++ ) { %>
                                            <option value="<%= marcas[i].id %>" <% if (talles[i].id===producto.id_marca)
                                                { %> selected <% } %> >
                                                    <%= marcas[i].descripcion %>
                                            </option>

                                            <% } %>
                                    </select>
                                </div>
                                <div class="error-container">
                                    <% if (mapsDeError.marca) { %>
                                        <p class="errorValidator">
                                            <%= mapsDeError.marca.msg %>
                                        </p>
                                        <% }%>
                                </div>
                                <div>
                                    <label for="talle">Talle: </label>
                                    <select name="talle" id="talle">
                                        <% for( let i=0; i < talles.length; i++ ) { %>
                                            <option value="<%= talles[i].id %>" <% if (talles[i].id===producto.id_talle)
                                                { %> selected <% } %> >
                                                    <%= talles[i].descripcion %>
                                            </option>

                                            <% } %>
                                    </select>
                                </div>
                                <div class="error-container">
                                    <% if (mapsDeError.talle) { %>
                                        <p class="errorValidator">
                                            <%= mapsDeError.talle.msg %>
                                        </p>
                                        <% }%>
                                </div>
                                <div>
                                    <label for="descripcion">Descripción del Producto:</label>
                                    <textarea type="text" name="descripcion"
                                        id="descripcion"><%= producto.descripcion%></textarea> 
                                        <br>
                                        </div>
                                        <span id="charCounter">Faltan 20 caracteres para el mínimo requerido (20).</span>
                                <div class="error-container">
                                        <% if (mapsDeError.descripcion) { %>
                                            <p class="errorValidator">
                                                <%= mapsDeError.descripcion.msg %>
                                            </p>
                                            <% }%>
                                    </div>
                                <div>
                                    <label for="imagen">Cambiar imagen del Producto</label>
                                </div>
                                <div>
                                    <img src="/images/products/<%= producto.imagen %>" alt="" width="200px"><br>
                                </div>
                                <div>
                                    <input type="file" name="imagen" id="imagen" value="<%=producto.imagen%>" />
                                    <input type="hidden" name="currentImage" value="<%= producto.imagen %>">
                                </div><br>
                                <div class="botones">
                                    <button class="boton-aceptar" type="submit" name="enviar"
                                        id="enviar">Confirmar</button>
                                    <button class="boton-cancelar" type="reset" class="boton-reset"
                                    onclick="location.href='/users/products';">Cancelar</button>
                                   
                                </div>
                            </form>
                        </section>
                </main>
                <script src="/js/product.js"></script>
                <% if (errorMessage && errorMessage.length > 0) { %>
                    <script>
                        Swal.fire({
                            title: 'Error',
                            text: '<%= errorMessage %>',
                            icon: 'error',
                            confirmButtonText: 'Aceptar'
                        });
                        </script>
                    
                    <% } %>
                <% if (successMessage && successMessage.length > 0) { %>
                    <script>
                        Swal.fire({
                            title: 'Producto editado',
                            text: '<%= successMessage %>',
                            icon: 'success',
                            confirmButtonText: 'Aceptar'
                        });
                        </script>
                    
                    <% } %>
                <%-include ('../partials/footer.ejs')%>
                  
    </body>

</html>